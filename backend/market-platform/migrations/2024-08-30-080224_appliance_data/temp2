Create table air_conditioner_aggregated(
	time timestamptz primary key,
	data float8
	);
Select create_hypertable('air_conditioner_aggregated',by_range('time'));

INSERT INTO air_conditioner_aggregated(data,time)
SELECT AVG(data), FORMAT('2023-02-14 %s:%s:%s',EXTRACT(HOUR FROM time),EXTRACT(MINUTE FROM time),EXTRACT(SECOND FROM time))::timestamptz as new_time
FROM open_em.air_conditioner 
Group By new_time
ORDER BY new_time ASC 

create table printer_3D_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('printer_3D_aggregated',by_range('time')); insert into printer_3D_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.printer_3D group by new_time order by new_time asc; 
create table air_purifier_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('air_purifier_aggregated',by_range('time')); insert into air_purifier_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.air_purifier group by new_time order by new_time asc; 
create table boiler_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('boiler_aggregated',by_range('time')); insert into boiler_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.boiler group by new_time order by new_time asc; 
create table coffee_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('coffee_aggregated',by_range('time')); insert into coffee_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.coffee group by new_time order by new_time asc; 
create table washing_machine_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('washing_machine_aggregated',by_range('time')); insert into washing_machine_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.washing_machine group by new_time order by new_time asc; 
create table computer_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('computer_aggregated',by_range('time')); insert into computer_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.computer group by new_time order by new_time asc; 
create table dehumidifier_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('dehumidifier_aggregated',by_range('time')); insert into dehumidifier_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.dehumidifier group by new_time order by new_time asc; 
create table dishwasher_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('dishwasher_aggregated',by_range('time')); insert into dishwasher_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.dishwasher group by new_time order by new_time asc; 
create table dryer_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('dryer_aggregated',by_range('time')); insert into dryer_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.dryer group by new_time order by new_time asc; 
create table fan_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('fan_aggregated',by_range('time')); insert into fan_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.fan group by new_time order by new_time asc; 
create table freezer_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('freezer_aggregated',by_range('time')); insert into freezer_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.freezer group by new_time order by new_time asc; 
create table fridge_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('fridge_aggregated',by_range('time')); insert into fridge_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.fridge group by new_time order by new_time asc; 
create table internet_router_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('internet_router_aggregated',by_range('time')); insert into internet_router_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.internet_router group by new_time order by new_time asc; 
create table laptop_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('laptop_aggregated',by_range('time')); insert into laptop_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.laptop group by new_time order by new_time asc; 
create table micro_wave_oven_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('micro_wave_oven_aggregated',by_range('time')); insert into micro_wave_oven_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.micro_wave_oven group by new_time order by new_time asc; 
create table phone_charger_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('phone_charger_aggregated',by_range('time')); insert into phone_charger_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.phone_charger group by new_time order by new_time asc; 
create table printer_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('printer_aggregated',by_range('time')); insert into printer_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.printer group by new_time order by new_time asc; 
create table radiator_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('radiator_aggregated',by_range('time')); insert into radiator_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.radiator group by new_time order by new_time asc; 
create table screen_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('screen_aggregated',by_range('time')); insert into screen_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.screen group by new_time order by new_time asc; 
create table solar_panel_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('solar_panel_aggregated',by_range('time')); insert into solar_panel_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.solar_panel group by new_time order by new_time asc; 
create table sound_system_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('sound_system_aggregated',by_range('time')); insert into sound_system_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.sound_system group by new_time order by new_time asc; 
create table tv_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('tv_aggregated',by_range('time')); insert into tv_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.tv group by new_time order by new_time asc; 
create table vaccuum_aggregated( time timestamptz primary key,	data float8	); select create_hypertable('vaccuum_aggregated',by_range('time')); insert into vaccuum_aggregated(data,time) select avg(data), format('2023-02-14 %s:%s:%s',extract(hour from time),extract(minute from time),extract(second from time))::timestamptz as new_time from open_em.vaccuum group by new_time order by new_time asc; 
